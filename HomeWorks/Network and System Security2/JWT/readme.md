# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ JWT (LAB01, LAB02, LAB03)

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ —Ç–µ–º–µ **—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π JWT**, –≤–∫–ª—é—á–∞—è –∞–ª–≥–æ—Ä–∏—Ç–º `none`, –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∏ –∞—Ç–∞–∫—É Algorithm Confusion (RS256 ‚Üí HS256).

README –¥–æ–ø–æ–ª–Ω–µ–Ω **—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –ø–æ—à–∞–≥–æ–≤—ã–º –≥–∞–π–¥–æ–º**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —É—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª.

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
JWT/
 ‚îú‚îÄ‚îÄ LAB01/
 ‚îú‚îÄ‚îÄ LAB02/
 ‚îú‚îÄ‚îÄ LAB03/
 ‚îî‚îÄ‚îÄ task/
```

---

# üß© LAB01 ‚Äî JWT: –æ–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω  
**–¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ (signature=None)  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Apprentice  
**–ò—Å—Ç–æ—á–Ω–∏–∫:**  
https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-unverified-signature

---

## üîß –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è  
–ò—Å–ø–æ–ª—å–∑—É—è –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π JWT, –∏–∑–º–µ–Ω–∏—Ç—å payload —Ç–æ–∫–µ–Ω–∞ —Ç–∞–∫, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω—è–ª –≤–∞—Å –∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (`administrator`) –∏ —Ä–∞–∑—Ä–µ—à–∏–ª —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `carlos`.

---

## üìò –ü–æ—à–∞–≥–æ–≤—ã–π –≥–∞–π–¥ –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é LAB01

### **1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å Burp Suite Community Edition.  
2. –í–∫–ª–∞–¥–∫–∞ **Proxy ‚Üí Open Browser**.  
3. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π.  
4. –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ö–æ–¥ `wiener:peter`.

---

### **2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ JWT**
1. –í **Proxy ‚Üí HTTP history** –Ω–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å –∫ `/my-account`.  
2. –í—ã–¥–µ–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å ‚Üí **Send to Repeater**.

---

### **3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞**
–í Repeater –∑–∞–º–µ–Ω–∏—Ç—å:

```
GET /my-account?id=wiener ‚Üí GET /admin
```

–û—Ç–≤–µ—Ç: `401 Unauthorized` ‚Äî –∑–Ω–∞—á–∏—Ç –ø–æ–¥–ø–∏—Å—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–ª–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–æ–≤—Å–µ.

---

### **4. –ü–æ–¥–¥–µ–ª–∫–∞ JWT**
–í —Ä–∞–∑–¥–µ–ª–µ **Inspector ‚Üí JSON Web Token**:

- –∏–∑–º–µ–Ω–∏—Ç—å payload:
```
"sub": "wiener" ‚Üí "administrator"
```

- –ø–æ–¥–ø–∏—Å—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É –º–µ–Ω—è—Ç—å –µ—ë –Ω–µ –Ω—É–∂–Ω–æ.

---

### **5. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
–ù–∞–∂–∞—Ç—å **Send** ‚Üí –ø–æ–ª—É—á–∞–µ–º:

```
HTTP/2 200 OK
```

---

### **6. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è carlos**

–ù–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å:

```
/admin/delete?username=carlos
```

–ò–∑–º–µ–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω.

---

## üìé –§–∞–π–ª—ã LAB01  
(–∫–ª–∏–∫ –ø–æ —Å—Å—ã–ª–∫–µ ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)

- [01_proxy_winner.jpg](LAB01/01_proxy_winner.jpg)
- [02_repeater.jpg](LAB01/02_repeater.jpg)
- [03_JWT.jpg](LAB01/03_JWT.jpg)
- [04_OK.jpg](LAB01/04_OK.jpg)
- [05_del_carlos.jpg](LAB01/05_del_carlos.jpg)
- [06_solution.jpg](LAB01/06_solution.jpg)

---

# üß© LAB02 ‚Äî JWT: alg=none (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏)  
**–¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** flawed signature verification  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Apprentice  
**–ò—Å—Ç–æ—á–Ω–∏–∫:**  
https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-flawed-signature-verification

---

## üîß –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è  
–ü–æ–¥–¥–µ–ª–∞—Ç—å —Ç–æ–∫–µ–Ω, –≤—ã—Å—Ç–∞–≤–∏–≤ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `alg: none`, –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞–≤ –ø–æ–¥–ø–∏—Å—å.

---

## üìò –ü–æ—à–∞–≥–æ–≤—ã–π –≥–∞–π–¥ –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é LAB02

### **1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
1. –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä Burp.  
2. –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É `wiener:peter`.  

---

### **2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ JWT**
1. –í **Proxy ‚Üí HTTP History** –Ω–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å –∫ `/my-account`.  
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ –≤ Repeater.

---

### **3. –ü–æ–¥–º–µ–Ω–∞ –ø—É—Ç–∏**
–í Repeater:

```
/my-account ‚Üí /admin
```

–û—Ç–≤–µ—Ç: `401`.

---

### **4. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞**
–í —Ä–∞–∑–¥–µ–ª–µ JWT Editor:

- Header:
```
"alg": "RS256" ‚Üí "none"
```

- Payload:
```
"sub": "wiener" ‚Üí "administrator"
```

- –£–¥–∞–ª–∏—Ç—å –≤—Å—ë –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–π —Ç–æ—á–∫–∏ (–ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞).

---

### **5. –ü—Ä–æ–≤–µ—Ä–∫–∞**
–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å:

```
HTTP/2 200 OK
```

---

### **6. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è carlos**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```
/admin/delete?username=carlos
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω.

---

## üìé –§–∞–π–ª—ã LAB02

- [01_proxy.jpg](LAB02/01_proxy.jpg)
- [02_Repeater.jpg](LAB02/02_Repeater.jpg)
- [03_none.jpg](LAB02/03_none.jpg)
- [04_administration.jpg](LAB02/04_administration.jpg)
- [05_JWT_del_sign.jpg](LAB02/05_JWT_del_sign.jpg)
- [06_del_carlos.jpg](LAB02/06_del_carlos.jpg)
- [07_solution.jpg](LAB02/07_solution.jpg)

---

# üß© LAB03 ‚Äî Algorithm Confusion (RS256 ‚Üí HS256)  
**–¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** Algorithm Confusion  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Expert  
**–ò—Å—Ç–æ—á–Ω–∏–∫:**  
https://portswigger.net/web-security/jwt/algorithm-confusion/lab-jwt-authentication-bypass-via-algorithm-confusion

---

## üîß –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è  
–ü–æ–ª—É—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π RSA-–∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π —Å–µ–∫—Ä–µ—Ç –∏ –ø–æ–¥–ø–∏—Å–∞—Ç—å —Ç–æ–∫–µ–Ω HS256.

---

## üìò –ü–æ—à–∞–≥–æ–≤—ã–π –≥–∞–π–¥ –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é LAB03

### **1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –∫–∞–∫ –∏ –≤ –ø—Ä–æ—à–ª—ã—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö.

---

### **2. –î–æ—Å—Ç—É–ø –∫ jwks.json**
1. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π –æ—Ç–∫—Ä—ã—Ç—å:  

```
/jwks.json
```

2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á (`n` ‚Äî –º–æ–¥—É–ª—å –∫–ª—é—á–∞).

---

### **3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ **JWT Editor** (BApp Store).  
2. –°–æ–∑–¥–∞—Ç—å **New RSA key** ‚Üí –≤—ã–±—Ä–∞—Ç—å **Public PEM**.  
3. –í—Å—Ç–∞–≤–∏—Ç—å –∫–ª—é—á ‚Üí –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å Base64.  
4. –ü–µ—Ä–µ–π—Ç–∏ –≤ **New Symmetric Key** ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å Base64 –≤ –ø–æ–ª–µ `k`.

---

### **4. –ü–æ–¥–¥–µ–ª–∫–∞ —Ç–æ–∫–µ–Ω–∞**
–í Repeater:

- Header:
```
"alg": "RS256" ‚Üí "HS256"
```

- Payload:
```
"sub": "wiener" ‚Üí "administrator"
```

- –ù–∞–∂–∞—Ç—å *Sign* (–ø–æ–¥–ø–∏—Å—å HS256 –Ω–∞ –±–∞–∑–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞).

---

### **5. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```
/admin/delete?username=carlos
```

carlos —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω.

---

## üìé –§–∞–π–ª—ã LAB03

- [01_proxy.jpg](LAB03/01_proxy.jpg)
- [02_repeat.jpg](LAB03/02_repeat.jpg)
- [03_json_key.jpg](LAB03/03_json_key.jpg)
- [04_JWT.jpg](LAB03/04_JWT.jpg)
- [05_Decode.jpg](LAB03/05_Decode.jpg)
- [06_gen_key.jpg](LAB03/06_gen_key.jpg)
- [07_new_key_sign.jpg](LAB03/07_new_key_sign.jpg)
- [08_admin_ok.jpg](LAB03/08_admin_ok.jpg)
- [09_del_carlos.jpg](LAB03/09_del_carlos.jpg)
- [10_solutions.jpg](LAB03/10_solutions.jpg)

---

# üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã

- [HW_JWT.docx](task/HW_JWT.docx) ‚Äî –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç  
- [–ó–∞–¥–∞–Ω–∏–µ_JWT.pdf](task/–ó–∞–¥–∞–Ω–∏–µ_JWT.pdf) ‚Äî –º–µ—Ç–æ–¥–∏—á–∫–∞

---

# üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ JWT

- –ó–∞–ø—Ä–µ—Ç–∏—Ç—å `alg=none`.
- –§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.
- –ù–µ –¥–æ–≤–µ—Ä—è—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º –∫–ª—é—á–∞–º (`jwk`, `kid`).
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å —Å—Ç—Ä–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º –∫–ª—é—á–æ–º.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞.
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å `iss`, `aud`, `exp`.
- –í–∫–ª—é—á–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –∫–ª—é—á–µ–π.

---

**–ê–≤—Ç–æ—Ä:** Novikov V. S.  
**–ì—Ä—É–ø–ø–∞:** –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞)  
**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 20.10.2025 

