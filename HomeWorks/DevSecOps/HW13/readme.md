# Домашнее задание по теме 13: обратная разработка уязвимостей.
**Разбор уязвимости CVE-2022-22965 (Spring4Shell)
**Дисциплина:** Разработка защищённых программных систем  
**Преподаватель:**   
**Студент:** Novikov V. S.  
**Дата выполнения:** 06 декабря 2025  


## 1. Описание задания
Цель — изучить жизненный цикл уязвимости, выполнить разбор исходного кода и патча, подготовить рекомендации по защите приложений и сетевого периметра.

## 2. Выбранная уязвимость
**CVE-2022-22965 (Spring4Shell)**  
CVSS 3.1: 9.8 (CRITICAL)  
Тип: RCE в Spring Framework  
Исправлена в версиях 5.3.18 и 5.2.20.

## 3. Жизненный цикл уязвимости

### 3.1. Как появилась
Причина — особенности Spring Data Binder + изменения в модульной системе JDK 9+, позволившие менять защищённые поля (`class.*`, `module.*`, `classLoader.*`) через HTTP-параметры.

### 3.2. Обнаружение
Исследователи AntGroup FG Security Lab; публичная регистрация — 1 апреля 2022 года.

### 3.3. Эксплуатация
Массовая эксплуатация за сутки после раскрытия: загрузка веб-шеллов, ботнета Mirai, массовое сканирование Интернет.

### 3.4. Исправление
Встроена фильтрация `disallowedFields` в WebDataBinder.  
Tomcat обновлён для закрытия вектора RCE при развёртывании WAR.

## 4. Детальный анализ

### 4.1. Уязвимый механизм
Spring Binder автоматически сопоставляет параметры HTTP с полями Java POJO.  
Злоумышленник мог передать параметры, ведущие к изменению настроек логирования и записи JSP на диск.

### 4.2. Анализ патча
Commit: https://github.com/spring-projects/spring-framework/commit/0024b09acd02fa4aa46811a9027fa3b42d6438e4  
Добавлены запреты на привязку полей `class.*`, `module.*`, `classLoader.*`.

## 5. Рекомендации

### 5.1. Тестирование собственных проектов
- Использовать версии Spring Framework >= 5.3.18.  
- Применять whitelist полей для привязки данных.  
- Использовать SAST/DAST (Semgrep, PT AI).  
- Предпочитать JAR-развёртывание Spring Boot, а не WAR.

### 5.2. Защита периметра
- WAF-правила блокировки параметров `class.*`, `module.*`.  
- SIEM-корреляции на массовые POST-запросы с подозрительными параметрами.  
- Мониторинг появления новых JSP-файлов.

## 6. Чек-лист самопроверки
- Все этапы выполнены  
- Жизненный цикл полностью описан  
- Приведён анализ кода и патча  
- Даны рекомендации по тестированию  
- Даны рекомендации по защите периметра  

---
