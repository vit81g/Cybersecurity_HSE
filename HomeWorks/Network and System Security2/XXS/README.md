# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ —Ç–µ–º–µ ¬´Cross-Site Scripting (XSS)¬ª

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:** Network and System Security  
**–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:** 10.03.01 ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª  
**–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞:** ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª  
**–í–£–ó:** –ù–ò–£ –í–®–≠, –ú–ò–≠–ú –∏–º. –ê.–ù. –¢–∏—Ö–æ–Ω–æ–≤–∞  

**–°—Ç—É–¥–µ–Ω—Ç:** –ù–æ–≤–∏–∫–æ–≤ –í. –°.  
**–ì—Ä—É–ø–ø–∞:** –ú–ö–ë-241  
**–ì–æ–¥:** 2025  

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
XSS/
‚îú‚îÄ‚îÄ Lab01/     # Reflected XSS + –æ–±—Ö–æ–¥ WAF (4,5 –±–∞–ª–ª–∞)
‚îú‚îÄ‚îÄ Lab02/     # DOM-based XSS (document.write, innerHTML)
‚îú‚îÄ‚îÄ Lab03/     # Reflected XSS (–∏–Ω—ä–µ–∫—Ü–∏—è –≤ –∞—Ç—Ä–∏–±—É—Ç)
‚îú‚îÄ‚îÄ Lab04/     # DOM-based XSS (JavaScript-–∫–æ–Ω—Ç–µ–∫—Å—Ç)
‚îî‚îÄ‚îÄ README.md
```

---

## üß™ Lab01 ‚Äî Reflected XSS –≤ HTML-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ç–µ–≥–æ–≤ –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (4,5 –±–∞–ª–ª–∞)

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** PortSwigger Web Security Academy  
**–£—Ä–æ–≤–µ–Ω—å:** Practitioner  
**–°—Å—ã–ª–∫–∞:**  
https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked  

---

### –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–í –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ reflected XSS-—É—è–∑–≤–∏–º–æ—Å—Ç—å, –∑–∞—â–∏—â—ë–Ω–Ω–∞—è WAF.  
WAF –±–ª–æ–∫–∏—Ä—É–µ—Ç:
- –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ HTML-—Ç–µ–≥–æ–≤;
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ JavaScript-–∞—Ç—Ä–∏–±—É—Ç—ã (`onerror`, `onclick`, `onload` –∏ —Ç.–ø.).

–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã **–Ω–µ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è**, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ XSS-—ç–∫—Å–ø–ª–æ–π—Ç–∞.

---

### –•–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

#### 1. –ü–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ XSS

–í –ø–∞—Ä–∞–º–µ—Ç—Ä `search` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –±–∞–∑–æ–≤—ã–π XSS-payload:

```
<img src=1 onerror=alert(document.cookie)>
```

–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
Tag is not allowed
```

–≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/01_alert.jpg`

---

#### 2. –ê–Ω–∞–ª–∏–∑ HTTP-—Ç—Ä–∞—Ñ–∏–∫–∞

–° –ø–æ–º–æ—â—å—é **Burp Suite ‚Üí Proxy ‚Üí HTTP history** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞.  
–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –Ω–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/02_http_proxy.jpg`

---

#### 3. –§–∞–∑–∑–∏–Ω–≥ HTML-—Ç–µ–≥–æ–≤

–ò—Å–ø–æ–ª—å–∑—É—è **Burp Intruder** –∏ —Å–ø–∏—Å–æ–∫ HTML-—Ç–µ–≥–æ–≤ –∏–∑ PortSwigger XSS Cheat Sheet, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–±–æ—Ä –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ç–µ–≥–æ–≤.

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- —Ç–µ–≥ `<body>` –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è WAF;
- —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP 200 OK.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/03_payload.jpg`

---

#### 4. –§–∞–∑–∑–∏–Ω–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å–æ–±—ã—Ç–∏–π

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–±–æ—Ä event-–∞—Ç—Ä–∏–±—É—Ç–æ–≤.

–í—ã—è–≤–ª–µ–Ω–æ, —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç:

```
onresize
```

–Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/04_payload_events.jpg`

---

### –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `<iframe>`.  
–ò–∑–º–µ–Ω–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã iframe –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è `onresize`.

Payload, —Ä–∞–∑–º–µ—â—ë–Ω–Ω—ã–π –Ω–∞ Exploit Server:

```html
<iframe src="https://TARGET.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E"
onload="this.style.width='100px'">
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –∞—Ç–∞–∫–∞ —Ç–∏–ø–∞ **drive-by**;
- –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- JavaScript-—Ñ—É–Ω–∫—Ü–∏—è `print()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/05_server.jpg`

---

### –†–µ–∑—É–ª—å—Ç–∞—Ç

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Ä–µ—à–µ–Ω–∞.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab01/06_solved.jpg`

---

## üß™ Lab02 ‚Äî DOM-based XSS

### –ó–∞–¥–∞–Ω–∏–µ 1 ‚Äî document.write (2,5 –±–∞–ª–ª–∞)

**–°—Å—ã–ª–∫–∞:**  
https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink  

#### –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–ó–Ω–∞—á–µ–Ω–∏–µ `location.search` –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `document.write`.  
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ HTML-–∫–æ–¥.

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π payload

```
"><svg onload=alert('test')>
```

- –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã—Ö–æ–¥ –∏–∑ HTML-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞;
- –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è SVG-—Ç–µ–≥;
- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `onload` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç JavaScript.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab02/01_doom.jpg`

---

### –ó–∞–¥–∞–Ω–∏–µ 2 ‚Äî innerHTML (2,5 –±–∞–ª–ª–∞)

**–°—Å—ã–ª–∫–∞:**  
https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-innerhtml-sink  

#### –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–î–∞–Ω–Ω—ã–µ –∏–∑ `location.search` –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤—É `innerHTML`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫–∏ –∫–∞–∫ HTML.

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π payload

```
<img src=1 onerror=alert('1_DOOM_XXS')>
```

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab02/02_doom.jpg`

---

## üß™ Lab03 ‚Äî Reflected XSS —Å –∏–Ω—ä–µ–∫—Ü–∏–µ–π –≤ –∞—Ç—Ä–∏–±—É—Ç (2,5 –±–∞–ª–ª–∞)

**–°—Å—ã–ª–∫–∞:**  
https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded  

### –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–£–≥–ª–æ–≤—ã–µ —Å–∫–æ–±–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º, –æ–¥–Ω–∞–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ HTML-–∞—Ç—Ä–∏–±—É—Ç–∞.  
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å –Ω–æ–≤—ã–π –∞—Ç—Ä–∏–±—É—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è.

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π payload

```
" onmouseover="alert('Reflected_XXS')
```

–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –∫—É—Ä—Å–æ—Ä–∞ –º—ã—à–∏.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç: `Lab03/01_alert.jpg`

---

## üß™ Lab04 ‚Äî DOM-based XSS –≤ JavaScript-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ (2,5 –±–∞–ª–ª–∞)

### –û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `location.search` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ JavaScript-–∫–æ–¥–∞ –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.  
–£—è–∑–≤–∏–º–æ—Å—Ç—å –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞.

üì∑ –°–∫—Ä–∏–Ω—à–æ—Ç—ã:
- `Lab04/01_code_page.jpg`
- `Lab04/02_solution.jpg`

---

## üõ°Ô∏è –ü–æ—á–µ–º—É –∞—Ç–∞–∫–∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –≤–æ–∑–º–æ–∂–Ω—ã

- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è;
- –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `innerHTML` –∏ `document.write`;
- –¥–æ–≤–µ—Ä–∏–µ –¥–∞–Ω–Ω—ã–º –∏–∑ `location.search`;
- reliance –Ω–∞ WAF –±–µ–∑ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

---

## üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—é XSS

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (HTML, –∞—Ç—Ä–∏–±—É—Ç—ã, JavaScript).
2. –ò—Å–∫–ª—é—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
   - `document.write`
   - `innerHTML`
3. –ü—Ä–∏–º–µ–Ω—è—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
   - `textContent`
   - `createElement`
   - `setAttribute`
4. –í–Ω–µ–¥—Ä–∏—Ç—å —Å—Ç—Ä–æ–≥—É—é **Content Security Policy (CSP)**.
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
6. –ù–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å WAF –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –∑–∞—â–∏—Ç—ã.

---

## –ò—Ç–æ–≥

–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ XSS-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç,
—á—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –≤–∫–ª—é—á–∞—é—â–µ–≥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É,
–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ API –∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É.
