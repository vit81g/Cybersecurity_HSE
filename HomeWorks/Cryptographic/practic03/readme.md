# ЭЦП по ГОСТ Р 34.10-2012 на Python

Репозиторий содержит учебную реализацию схемы электронной цифровой подписи (ЭЦП) по стандарту ГОСТ Р 34.10-2012 на языке Python. Код снабжён подробными комментариями и описанием функций.

---

## Содержание

- [Обзор](#обзор)  
- [Возможности](#возможности)  
- [Требования](#требования)  
- [Установка](#установка)  
- [Использование](#использование)  
  - [Генерация ключей](#генерация-ключей)  
  - [Подпись сообщения](#подпись-сообщения)  
  - [Проверка подписи](#проверка-подписи)  
- [Описание ключевых функций](#описание-ключевых-функций)  
- [Список литературы](#список-литературы)  

---

## Обзор

Данный проект демонстрирует:
- построение группы точек эллиптической кривой над полем Fₚ;
- операции сложения и умножения точек на скаляр;
- хэширование сообщения (SHA-256 для примера, заменяемое на ГОСТ 34.11-2012);
- алгоритм подписи (r, s) и проверку ЭЦП по ГОСТ Р 34.10-2012.

---

## Возможности

- Генерация пары ключей `(d, Q = d·G)`
- Формирование подписи `(r, s)` для любого файла
- Проверка подписи для файла и вывод результата
- Подробные комментарии и аннотации в коде

---

## Требования

- Python 3.7+
- Модуль `hashlib` (входит в стандартную библиотеку)
- (опционально) готовая реализация ГОСТ 34.11-2012 для хэширования

---

## Установка

1. Скачать файл

2. (Опционально) создайте виртуальное окружение и активируйте:
   ```bash
   python -m venv .venv
   source .venv/bin/activate   # Linux/macOS
   .\.venv\Scripts\activate    # Windows
   ```

---

## Использование

Скрипт `<script>.py` предлагает три режима:
1. **generate** — генерация ключей  
2. **sign** — подпись файла  
3. **verify** — проверка подписи  

Запуск:
```bash
python <script>.py
```

### Генерация ключей

```text
Выберите операцию (generate/sign/verify): generate
# после ввода — получите:
Секретный ключ d = 123456789
Публичный ключ Q = (x₀, y₀)
```

### Подпись сообщения

```text
Выберите операцию (generate/sign/verify): sign
Путь к файлу сообщения: message.txt
Путь к файлу подписи:   signature.txt
Введите секретный ключ d: 123456789
# В результате — файл signature.txt со строкой "r s"
```

### Проверка подписи

```text
Выберите операцию (generate/sign/verify): verify
Путь к файлу сообщения: message.txt
Путь к файлу подписи:   signature.txt
Введите публичный ключ Q (x y): x₀ y₀
# Результат проверки выводится в консоли и записывается в verify_result.txt
```

---

## Описание ключевых функций

- `extended_gcd(a, b)` — расширенный алгоритм Евклида, возвращает `(gcd, x, y)`.
- `mod_inverse(a, m)` — вычисление обратного по модулю, использует `extended_gcd`.
- Класс `EllipticCurve(a, b, p)`:
  - `is_point_on_curve(P)` — проверка точки на кривой.
  - `add_points(P, Q)` — сложение двух точек (с учётом всех случаев).
  - `multiply_point(P, k)` — умножение точки на скаляр.
- `hash_message(message)` — пример хэширования через SHA-256 → целое число.
- `generate_keypair(curve, G, q)` — генерация `(d, Q)`.
- `sign_message(message, curve, G, q, d)` — формирование подписи `(r, s)`.
- `verify_signature(message, signature, curve, G, q, Q)` — проверка подписи по ГОСТ Р 34.10-2012.
- `process_file(...)` — утилита для подписи/проверки файлов.
- `main()` — CLI-интерфейс для пользователя.

---

## Список литературы

1. **ГОСТ Р 34.10-2012** «Информационная технология. Криптографическая защита информации. Цифровая подпись».  
2. **ГОСТ Р 34.11-2012** «Информационная технология. Криптографическая защита информации. Хэш-функция».  
3. Стинсон Д. «Криптография: теория и практика». — М.: Техносфера, 2006.  
4. Мензис А., ван Оорсхот П., Ванстоун С. «Эллиптические кривые в криптографии». — М.: Диалектика, 2004.  
5. Paar B., Pelzl J. «Понимание криптографии». — СПб.: Питер, 2017.  
6. Hoffstein J., Pipher J., Silverman J. «An Introduction to Mathematical Cryptography». — Springer, 2008.  
7. Schneier B. «Прикладная криптография». — М.: Вильямс, 2002.  
8. Python Software Foundation. *Python 3.x Documentation*. — https://docs.python.org/3/  
