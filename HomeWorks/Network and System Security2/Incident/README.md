# Попытка кражи денежных средств с Android-устройства

## Анализ инцидента с использованием модели Cyber Kill Chain

------------------------------------------------------------------------

## 1. Введение

В 2024 году наблюдается значительный рост атак с использованием
мобильного трояна SpyNote. По данным «Лаборатории Касперского», за 9
месяцев 2024 года количество атак увеличилось в 4,5 раза по сравнению с
аналогичным периодом 2023 года.

Источник: https://xakep.ru/2024/10/23/spynote-attacks/

------------------------------------------------------------------------

## 2. Краткое описание SpyNote

SpyNote --- Android RAT (Remote Access Trojan) со следующими
возможностями:

-   удалённое управление устройством
-   отправка и перехват SMS
-   перехват push-уведомлений
-   кража учётных данных
-   запись экрана
-   доступ к микрофону и камере
-   скрытие иконки
-   использование Accessibility Service

Исходный код утёк в 2020 году, что привело к появлению множества
модификаций: Spyroid, CraxsRAT, EagleRat.

------------------------------------------------------------------------

## 3. Описание инцидента

Жертва --- пожилой человек.

1.  Поступает звонок через WhatsApp якобы от поддержки МТС.
2.  Сообщают об отрицательном балансе.
3.  Предлагают помощь.
4.  Пользователь устанавливает APK-файл.
5.  На устройстве появляется фейковое приложение MTS с трояном SpyNote.
6.  Отправляется SMS на номер 900 с текстом «вклад».
7.  Пользователь включает авиарежим --- атака прерывается.

------------------------------------------------------------------------

## 4. Возможные инструменты удалённого доступа

Помимо SpyNote, могли использоваться:

-   AnyDesk (модифицированные версии)
-   TeamViewer QuickSupport
-   RustDesk
-   AirDroid
-   AndroRAT

------------------------------------------------------------------------

## 5. Как произошла отправка SMS

### Вариант 1 --- через SpyNote

-   Получение разрешений SEND_SMS и READ_SMS
-   Автоматическая отправка SMS
-   Перехват ответа банка
-   Передача данных злоумышленнику через C2

### Вариант 2 --- через удалённый помощник

-   Злоумышленник управляет экраном
-   Самостоятельно отправляет SMS
-   Получает доступ к банковской информации

------------------------------------------------------------------------

## 6. Возможное развитие атаки

### Сценарий 1 --- через SMS-банк

-   Запрос информации о вкладах
-   Инициирование перевода
-   Перехват кода подтверждения
-   Подтверждение операции

### Сценарий 2 --- через банковское приложение

-   Перехват push-уведомлений
-   Использование Accessibility для подтверждения перевода
-   Перевод средств на счёт злоумышленников

------------------------------------------------------------------------

## 7. Разбор по модели Cyber Kill Chain

### 1. Reconnaissance

Выбор уязвимой жертвы.

### 2. Weaponization

Создание модифицированного APK с SpyNote.

### 3. Delivery

Доставка через WhatsApp.

### 4. Exploitation

Получение разрешений и активация вредоносного кода.

### 5. Installation

Закрепление трояна в системе.

### 6. Command & Control

Связь с управляющим сервером.

### 7. Actions on Objectives

Попытка хищения денежных средств.

------------------------------------------------------------------------

## 8. Почему атака была остановлена

Включение авиарежима:

-   разорвало соединение с C2
-   остановило удалённое управление
-   предотвратило подтверждение операций

------------------------------------------------------------------------

## 9. Рекомендации

1.  Запрет установки APK вне Google Play
2.  Контроль разрешений Accessibility
3.  Использование мобильной защиты
4.  Обучение пользователей противодействию социальной инженерии
5.  Усиленная аутентификация в банковских приложениях

------------------------------------------------------------------------

Документ подготовлен для учебного анализа инцидента в рамках направления
«Кибербезопасность».
